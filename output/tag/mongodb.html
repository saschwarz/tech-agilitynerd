<!DOCTYPE html>
<html lang="en">
<head>
        <title>tech.agilitynerd.com - mongodb</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="../theme/css/main.css" type="text/css" />
                <link href="http://tech.agilitynerd.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="tech.agilitynerd.com Atom Feed" />
                
        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="../css/ie.css"/>
                <script src="../js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="../css/ie6.css"/><![endif]-->

</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="../">tech.agilitynerd.com </a></h1>
                <nav><ul>
                                                                                                    <li ><a href="../category/about.html">about</a></li>
                                    <li ><a href="../category/devops.html">devops</a></li>
                                    <li ><a href="../category/misc.html">misc</a></li>
                                    <li ><a href="../category/programming.html">programming</a></li>
                                    <li ><a href="../category/python.html">python</a></li>
                                    <li ><a href="../category/webdev.html">webdev</a></li>
                                </ul></nav>
        </header><!-- /#banner -->
                
            

                            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="../blosxom-hitcounter-favorites-and-lastread-plugins-for-mongodb.html">Blosxom hitcounter, favorites and lastread plugins for MongoDB</a></h1> 
                    <footer class="post-info">
        <abbr class="published" title="2010-05-17T10:48:00">
                Mon 17 May 2010
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/steve-schwarz.html">Steve Schwarz</a>
        </address>
        <p>In <a href="../category/webdev.html">webdev</a>. </p>
<p>tags: <a href="../tag/blosxom.html">blosxom</a><a href="../tag/mongodb.html">mongodb</a><a href="../tag/perl.html">perl</a><a href="../tag/webdevelopment.html">webdevelopment</a></p>
</footer><!-- /.post-info --><p>When I wrote my plugins for tracking the visits to each page
(<tt class="docutils literal">hitcounter</tt>), presenting the counts by popularity (<tt class="docutils literal">favorites</tt>), and
displaying the most recently read posts (<tt class="docutils literal">lastread</tt>) I used Perl's
<tt class="docutils literal">Storable</tt> module as a simple way to serialize the data structure to and
from disk. At the time I wasn't too concerned with performance, my blog
<a class="reference external" href="http://agilitynerd.com">agilitynerd.com</a> didn't suffer under the load of the disk reads/writes.</p>
<p>But periodically I get DOS'd and my website becomes unresponsive. Not
too suprising since Blosxom has to run as a plain CGI script; but I'm
certain the disk writes of these plugins weren't helping. Occasionally
the Storable on disk would become corrupted which would take down the
site (not enough exception handling in the plugins).</p>
<p>I decided to go with <a class="reference external" href="http://mongodb.org">Mongo</a> as the backing data store to remove the
disk reads/write from the cgi script. It supports an increment operation
(ala memcached) so multiple threads can update the hit count and MongoDB
will &quot;do the right thing&quot;. It also has a query API that made rewriting
favorites and lastread trivial.</p>
<div style="float:right;padding 20px;"><p><img alt="Poweredmongodbgreen75" src="/static/images/2010/05/9077760-PoweredMongoDBgreen75.png" /></p>
</div><p>I haven't tested the performance but my website, especially the
favorites page, seems faster. Once I write a JavaScript client to update
the hitcounts I'll be able to move the website to a fully cached
deployment while still tracking hits which should make the load of
running the agilitynerd blog very low.</p>
<p>I've hosted the plugins on github:
<a class="reference external" href="http://github.com/saschwarz/blosxom-mongodb-plugins">http://github.com/saschwarz/blosxom-mongodb-plugins</a> The mongohitcounter
plugin can be configured to automatically import existing count data
from the hitcounter plugin's Storable. So conversion to the new plugins
just requires updating the template's variables to the new plugin names.</p>
                </article>
                                    <p class="paginator">
        Page 1 / 1
    </p>
                            </aside><!-- /#featured -->
                                                </ol><!-- /#posts-list -->
                        </section><!-- /#content -->
                    <section id="extras" class="body">
                                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="http://tech.agilitynerd.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>
                            
                                                </ul>
                </div><!-- /.social -->
                </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>