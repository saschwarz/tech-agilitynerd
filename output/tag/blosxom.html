<!DOCTYPE html>
<html lang="en">
<head>
        <title>tech.agilitynerd.com - blosxom</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="../theme/css/main.css" type="text/css" />
                <link href="http://tech.agilitynerd.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="tech.agilitynerd.com Atom Feed" />
                
        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="../css/ie.css"/>
                <script src="../js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="../css/ie6.css"/><![endif]-->

</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="../">tech.agilitynerd.com </a></h1>
                <nav><ul>
                                                                                                    <li ><a href="../category/about.html">about</a></li>
                                    <li ><a href="../category/devops.html">devops</a></li>
                                    <li ><a href="../category/misc.html">misc</a></li>
                                    <li ><a href="../category/programming.html">programming</a></li>
                                    <li ><a href="../category/python.html">python</a></li>
                                    <li ><a href="../category/webdev.html">webdev</a></li>
                                </ul></nav>
        </header><!-- /#banner -->
                
            

                            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="../blosxom-plugin-for-generating-facebook-commen.html">Blosxom Plugin for Generating Facebook Comment xids</a></h1> 
                    <footer class="post-info">
        <abbr class="published" title="2010-11-23T05:00:00">
                Tue 23 November 2010
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/steve-schwarz.html">Steve Schwarz</a>
        </address>
        <p>In <a href="../category/webdev.html">webdev</a>. </p>
<p>tags: <a href="../tag/blosxom.html">blosxom</a><a href="../tag/comments.html">comments</a><a href="../tag/facebook.html">facebook</a><a href="../tag/perl.html">perl</a></p>
</footer><!-- /.post-info --><p>I've been using <a class="reference external" href="http://www.blosxom.com/">Blosxom</a> to power my dog agility blog for over 6
years. In the past year or so I've enabled <a class="reference external" href="http://developers.facebook.com/docs/reference/plugins/comments">Facebook comments</a> in
addition to my site's own comment plugin. I ran into a problem using
Facebook's comments: if the user enters a comment on a page and the URL
has any additional URL parameters then the comment is only associated
with the page when accessed with those parameters, others hitting the
page w/o parameters won't see the comments.</p>
<p>This behavior is <a class="reference external" href="http://developers.facebook.com/docs/reference/fbml/comments_%28XFBML%29">documented by Facebook</a> when the <tt class="docutils literal">xid</tt> attribute
isn't set in <tt class="docutils literal">fb:comments</tt> HTML element. I didn't think I'd encounter this
situation since my blog post URLs don't contain any parameters. However,
when people link to one of my articles within Facebook, Facebook appends
various parameters to the base URL.</p>
<p>The solution is to specify an <tt class="docutils literal">xid</tt> attribute in the <tt class="docutils literal">fb:comments</tt> element
containing the URL encoded URL of the page (Facebook's default <tt class="docutils literal">xid</tt>).
This causes existing comments to show up and causes comments created
when the page is loaded with URL parameters to use the same encoded URL.</p>
<p>So I created a simple Blosxom plugin to perform the encoding so the
encoded URL can be placed in the story.html template:</p>
<pre class="code perl literal-block">
<span class="c1"># Blosxom Plugin: urlencode -*- perl -*-</span>
<span class="c1"># Author: Steve Schwarz &lt;http://agilitynerd.com/&gt;</span>
<span class="c1"># 2010-NOV-22    0.1 initial version.package urlencode;</span>
<span class="c1"># puts the urlencoded string of the URL for this page</span>
<span class="c1"># into $urlencode::url without any params# use this in fb.comments xid to give the same xid</span>
<span class="c1"># even when query params are provided</span>
<span class="c1"># -------------------</span>
<span class="k">use</span> <span class="n">CGI</span> <span class="sx">qw/:standard/</span><span class="p">;</span>
<span class="k">use</span> <span class="n"></span><span class="nn">URI::</span><span class="n">Escape</span><span class="p">;</span>

<span class="k">sub </span><span class="nf">start</span> <span class="p">{</span>
    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
<span class="nv">$url</span> <span class="o">=</span> <span class="s">''</span><span class="p">;</span>

<span class="k">sub </span><span class="nf">story</span> <span class="p">{</span>
    <span class="k">my</span> <span class="p">(</span><span class="nv">$pkg</span><span class="p">,</span> <span class="nv">$path</span><span class="p">,</span> <span class="nv">$filename</span><span class="p">,</span> <span class="nv">$story_ref</span><span class="p">,</span> <span class="nv">$title_ref</span><span class="p">,</span> <span class="nv">$body_ref</span><span class="p">)</span> <span class="o">=</span> <span class="nv">&#64;_</span><span class="p">;</span>
    <span class="nv">$</span><span class="nn">urlencode::</span><span class="nv">url</span> <span class="o">=</span> <span class="n">uri_escape</span><span class="p">(</span><span class="s">&quot;$blosxom::url/${blosxom::path_info}&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
<span class="mi">1</span><span class="p">;</span>
</pre>
<p>Then it is used in the story template:</p>
<pre class="literal-block">
&lt;fb:comments width=&quot;550&quot; numposts=&quot;5&quot; xid=&quot;$urlencode::url&quot;&gt;&lt;/fb:comments&gt;
</pre>
<p>Now my readers won't have to worry that their comments won't show up.</p>
                </article>
                            </aside><!-- /#featured -->
                            <section id="content" class="body">
                    <h1>Other articles</h1>
                    <hr />
                    <ol id="posts-list" class="hfeed">
                                                

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../blosxom-hitcounter-favorites-and-lastread-plugins-for-mongodb.html" rel="bookmark"
                           title="Permalink to Blosxom hitcounter, favorites and lastread plugins for MongoDB">Blosxom hitcounter, favorites and lastread plugins for MongoDB</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2010-05-17T10:48:00">
                Mon 17 May 2010
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/steve-schwarz.html">Steve Schwarz</a>
        </address>
        <p>In <a href="../category/webdev.html">webdev</a>. </p>
<p>tags: <a href="../tag/blosxom.html">blosxom</a><a href="../tag/mongodb.html">mongodb</a><a href="../tag/perl.html">perl</a><a href="../tag/webdevelopment.html">webdevelopment</a></p>
</footer><!-- /.post-info -->                <p>When I wrote my plugins for tracking the visits to each page
(<tt class="docutils literal">hitcounter</tt>), presenting the counts by popularity (<tt class="docutils literal">favorites</tt>), and
displaying the most recently read posts (<tt class="docutils literal">lastread</tt>) I used Perl's
<tt class="docutils literal">Storable</tt> module as a simple way to serialize the data structure to and
from disk. At the time I ...</p>
                <a class="readmore" href="../blosxom-hitcounter-favorites-and-lastread-plugins-for-mongodb.html">read more</a>
                                </div><!-- /.entry-content -->
            </article></li>
                            

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../improving-site-navigation-add-titles-to-blosx-1.html" rel="bookmark"
                           title="Permalink to Improving Site Navigation - Add Titles to Blosxom Pages With storytitle">Improving Site Navigation - Add Titles to Blosxom Pages With storytitle</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2008-06-20T22:03:00">
                Fri 20 June 2008
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/steve-schwarz.html">Steve Schwarz</a>
        </address>
        <p>In <a href="../category/webdev.html">webdev</a>. </p>
<p>tags: <a href="../tag/agilitynerd.html">agilitynerd</a><a href="../tag/blosxom.html">blosxom</a><a href="../tag/googleanalytics.html">googleanalytics</a></p>
</footer><!-- /.post-info -->                <p>I've always wanted my <a class="reference external" href="http://agilitynerd.com/blog/">AgilityNerd</a> blog to serve as a reference for
interesting dog agility subjects. Consequently, I'm interested in making
it as easy as possible for readers to locate, explore, and learn more
about the sport. So improving navigation is a strong interest to me.</p>
<p>I have ...</p>
                <a class="readmore" href="../improving-site-navigation-add-titles-to-blosx-1.html">read more</a>
                                </div><!-- /.entry-content -->
            </article></li>
                            

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../blosxom-plugin-lastcommented-enhancement-1.html" rel="bookmark"
                           title="Permalink to Blosxom Plugin lastcommented Enhancement">Blosxom Plugin lastcommented Enhancement</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2008-02-29T18:50:00">
                Fri 29 February 2008
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/steve-schwarz.html">Steve Schwarz</a>
        </address>
        <p>In <a href="../category/webdev.html">webdev</a>. </p>
<p>tags: <a href="../tag/blosxom.html">blosxom</a><a href="../tag/plugin.html">plugin</a></p>
</footer><!-- /.post-info -->                <p>I had a comment entered on my <a class="reference external" href="http://agilitynerd.com/blog">dog agility blog</a> that I
subsequently deleted and of course my <tt class="docutils literal">lastcommented</tt> plugin recorded
the comment as the most recent comment. Since the plugin uses
<tt class="docutils literal">Storable</tt> to store the data I couldn't manually edit the file to
remove the entry.</p>
<p>So I ...</p>
                <a class="readmore" href="../blosxom-plugin-lastcommented-enhancement-1.html">read more</a>
                                </div><!-- /.entry-content -->
            </article></li>
                            

                 
                        <li><article class="hentry">    
                <header>
                    <h1><a href="../minor-additional-mods-to-blosxom-moreenties-p-1.html" rel="bookmark"
                           title="Permalink to Minor Additional Mods to Blosxom moreenties Plugin">Minor Additional Mods to Blosxom moreenties Plugin</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2008-02-24T16:24:00">
                Sun 24 February 2008
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="../author/steve-schwarz.html">Steve Schwarz</a>
        </address>
        <p>In <a href="../category/webdev.html">webdev</a>. </p>
<p>tags: <a href="../tag/blosxom.html">blosxom</a><a href="../tag/plugin.html">plugin</a></p>
</footer><!-- /.post-info -->                <p>I had previously extended Jason Clark's <a class="reference external" href="http://jclark.org/weblog/WebDev/Blosxom/plugins/moreentries">moreentries</a> plugin for
<a class="reference external" href="http://blosxom.sourceforge.net/">Blosxom</a> to allow adding images to links to the previous and next
group of articles/entries in the head or foot of a Blosxom weblog. While
attempting to have valid HTML on my blogs I found that I had left ...</p>
                <a class="readmore" href="../minor-additional-mods-to-blosxom-moreenties-p-1.html">read more</a>
                                </div><!-- /.entry-content -->
            </article></li>
                            </ol><!-- /#posts-list -->
                            <p class="paginator">
        Page 1 / 4
            <a href="../tag/blosxom2.html">&raquo;</a>
    </p>
                        </section><!-- /#content -->
                    <section id="extras" class="body">
                                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="http://tech.agilitynerd.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>
                            
                                                </ul>
                </div><!-- /.social -->
                </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>