<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <title>tech.agilitynerd.com</title>
    <meta name="description" content="">
    <meta name="author" content="Steve Schwarz">
        
    <!-- Le styles -->
    <link href="./theme/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <style type="text/css">
      body {
      padding-top: 60px;
      padding-bottom: 40px;
      }
      .sidebar-nav {
      padding: 9px 0;
      }
    </style>
    <link href="./theme/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet">
    <link href="./theme/local.css" rel="stylesheet">
    <link href="./theme/pygments.css" rel="stylesheet">
          </head>
  <body>
<!--[if lt IE 7]><p class=chromeframe>Your browser is <em>ancient!</em> <a href="http://browsehappy.com/">Upgrade to a different browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to experience this site.</p><![endif]-->
            
    <div class="navbar navbar-inverse navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container-fluid">
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
	<span class="icon-bar"></span>
	<span class="icon-bar"></span>
	<span class="icon-bar"></span>
      </a>
      <a class="brand" href="./index.html">tech.agilitynerd.com</a>
      <div class="nav-collapse collapse">
	<ul class="nav">
	  	  	  	  	  	  <li ><a href="./category/devops.html">devops</a></li>
	  	  <li ><a href="./category/misc.html">misc</a></li>
	  	  <li ><a href="./category/programming.html">programming</a></li>
	  	  <li ><a href="./category/python.html">python</a></li>
	  	  <li class="active"><a href="./category/webdev.html">webdev</a></li>
	  	</ul>
	<p class="navbar-text pull-right">
	  <a class="navbar-link" href="./archives.html">[archives]</a>
	  <a class="navbar-link" href="./tags.html">[tags]</a>
	</p>
      </div><!--/.nav-collapse -->
    </div>
  </div>
</div>
    <div class="container-fluid">
      <div class="row-fluid">
	<div class="span1">&nbsp;</div>
	<div class="span10">
	  <div class="row-fluid">
            <div class="span9">
	      	      <div class='article'>
  <div class="page-header"><h1>Reducing the Cost of Client Side Analytics</h1></div>
  <div class="well small"><a class="more" href="./reducing-the-impact-of-client-side-analytics.html">On 12 Jan 2012 at 2210</a>
by <a class="url fn" href="./author/steve-schwarz.html">Steve Schwarz</a> in <a href="./category/webdev.html">webdev</a>
 | <a href="./reducing-the-impact-of-client-side-analytics.html#disqus_thread">Comments</a></div>
  <div><p>I read&nbsp;<a class="reference external" href="http://blog.mozilla.com/webdev/2012/01/06/timing-amo-user-experience/">Andy McKay's blog post on timing user experience</a>&nbsp;on the
<a class="reference external" href="http://blog.mozilla.com/webdev">Mozilla Webdev blog</a>&nbsp;the other day and it reminded me of an idea I was
thinking about for measuring client side timings at work. I had been
toying with the idea of rolling our own library to capture JavaScript
rendering time for our JS heavy pages (grids of hundreds of lines of
data).</p>
<p>Andy's post mentions the <a class="reference external" href="http://yahoo.github.com/boomerang/doc/">boomerang JavaScript library</a>&nbsp;and when I was
reading it's docs they pointed out potential for abuse/load on the URL
used to report the timings. For each instrumented page boomerang can hit
the &quot;beacon&quot; URL to report the statistics it collects. So in the worst
case you could double your page hits - although for specific
pages/samples recording a few statistics shouldn't be too costly for low
volume sites.</p>
<p>One solution is to only sample the pages/users of interest; selecting
the sample could occur on the server and/or client. But another solution
would be to collect statistics across multiple pages and periodically
send batches of analytics to the beacon URL.</p>
<p>I've been playing with mobile web development for
<a class="reference external" href="http://m.agilitycourses.com/">agilitycourses.com</a>&nbsp;lately and will soon let users store the courses
they create in localStorage on their browser. That got me thinking that
<a class="reference external" href="http://en.wikipedia.org/wiki/Web_Storage#Local_and_session_storage">sessionStorage</a> could be used to store analytics across pages and then
periodically send the stats to the server. This would reduce the number
of hits on the beacon, allowing deployment to a larger sample of
clients. It also gets flushed once the session is closed and (if kept
small) doesn't prompt the user to approve storing the data.</p>
<p>A lot of modern <a class="reference external" href="http://www.delicious.com/redirect?url=http%3A//dev-test.nemikor.com/web-storage/support-test/">browsers support session storage</a>&nbsp;and for my purposes
only ones with support would be relevant - due to our browser support
policy at work.</p>
<p>The other problem the boomerang docs discuss is<a class="reference external" href="http://yahoo.github.com/boomerang/doc/howtos/howto-7.html">abuse of the beacon</a>
(accidental or malicious). A solution would be to piggyback reporting of
analytics into application form post payloads. This is trickier to
implement and it suffers from coupling analytic reporting into the
application itself.</p>
<p>To try to solve it some what generally... The client side JS library
could add a hidden field to any/some/specific forms into which it writes
the analytics data collected thus far. If it hooked the form submit
callback it could know if the form was successfully submitted and clear
the session storage.</p>
<p>Server side middleware could detect the hidden analytics field in the
form and extract/store the data. It could also remove the field before
passing the request data along to the app server.</p>
<p>All in all a fair amount of twiddling to keep from exposing a recording
URL to the outside world.</p>
<p>Of course if an authenticated session was being used then abusers would
have to have a valid session to post to the beacon URL.</p>
<p>I don't know if I will have time to play with the sessionStorage idea
but I think it might be a worthwhile extension to boomerang or other
client side analytics capture libraries.</p>
</div>
  <div class="tags">Tagged as: <a href="./tag/analytics.html">analytics</a> <a href="./tag/boomerang.html">boomerang</a> <a href="./tag/javascript.html">javascript</a> <a href="./tag/sessionstorage.html">sessionstorage</a> <a href="./tag/webdevelopment.html">webdevelopment</a> </div>  </div>	
            </div><!--/span-->

	    <div class="span3">
	      
<img src=""/>
<h4>About</h4>
<div>
  <p class="about">I'm Steve Schwarz a software developer in the Chicago area. <a href="/pages/about.html">more</a></p>
</div>
<div class="well sidebar-nav">
    <ul class="nav nav-list">
    <li class="nav-header">Blogroll</li>
        <li><a href="http://agilitynerd.com/blog/">agilitynerd.com</a></li>
        <li><a href="http://agilitycourses.com/">agilitycourses.com</a></li>
        <li><a href="http://googility.com/">googility.com</a></li>
      </ul>
      <ul class="nav nav-list social">
    <li class="nav-header">Elsewhere</li>
        <li><a href="http://www.linkedin.com/profile/view?id=10135443">Linked in</a></li>
        <li><a href="https://github.com/saschwarz">GitHub</a></li>
      </ul>
  </div><!--/.well -->
            </div><!--/span-->

	  </div>
	</div>
      </div><!--/row-->

      <hr>

      <footer>
        <p>Powered by <a href="http://alexis.notmyidea.org/pelican/">Pelican</a></p>
	<p>&copy; Steve Schwarz 2013</p>
      </footer>

    </div><!--/.fluid-container-->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="./theme/js/jquery-1.7.2.min.js"><\/script>')</script>
      <script src="./theme/bootstrap/js/bootstrap.min.js"></script>
      <script src="./theme/js/modernizr-2.5.3-respond-1.1.0.min.js"></script>

  </body>
</html>